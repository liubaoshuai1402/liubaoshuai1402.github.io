<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>LAMMPS on BOGHTW</title>
    <link>https://liubaoshuai1402.github.io/series/lammps/</link>
    <description>Recent content in LAMMPS on BOGHTW</description>
    <generator>Hugo</generator>
    <language>zh-cn</language>
    <lastBuildDate>Tue, 17 Jun 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://liubaoshuai1402.github.io/series/lammps/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>LAMMPS-dump</title>
      <link>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/dump/</link>
      <pubDate>Tue, 17 Jun 2025 00:00:00 +0000</pubDate>
      <guid>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/dump/</guid>
      <description>&lt;h1 id=&#34;有用的dump&#34;&gt;有用的dump&lt;/h1&gt;&#xA;&lt;h3 id=&#34;1-如何由lammps的轨迹转化为poscar&#34;&gt;1. 如何由lammps的轨迹转化为POSCAR&lt;/h3&gt;&#xA;&lt;p&gt;构建机器学习势时，通常需要主动学习。主动学习就需要将用MLIAP跑出来的结果返回到DFT中进行计算。&lt;/p&gt;&#xA;&lt;p&gt;具体来讲，要将分子动力学轨迹转化为第一性原理的输入格式。（如从lammps到vasp）&lt;/p&gt;&#xA;&lt;p&gt;lammps并不直接支持输出POSCAR格式，比较容易想到的思路是让lammps输出xyz文件，再有xyz文件转化为POSCAR。&lt;/p&gt;&#xA;&lt;p&gt;不过麻烦的一点是，lammps输出xyz文件并不带有晶格大小的信息，无法转化为POSCAR。&lt;/p&gt;&#xA;&lt;p&gt;这里，我目前的方案是，先用custom style的dump输出文件，如下：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;dump          1 all custom 1 dump20nvt id element x y z&#xD;&#xA;dump_modify   1 sort id element O Zr Y H&#xD;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;为了避免输出lammps中的type，而不是元素符号，这里修饰一下dump（即 &lt;code&gt;element O Zr Y H&lt;/code&gt;），这里O、Zr、Y、H分别对应 type 1、2、3、4&lt;/p&gt;&#xA;&lt;p&gt;sort id 必不可少，保证原子对应。&lt;/p&gt;&#xA;&lt;p&gt;这样得到的dump文件格式，如下：&lt;/p&gt;&#xA;&lt;img src=&#34;https://xiaoxiaobuaigugujiao.oss-cn-beijing.aliyuncs.com/img/dump%E7%9A%84custom%E9%A3%8E%E6%A0%BC.png&#34; style=&#34;zoom:70%;&#34; /&gt;&#xD;&#xA;&lt;p&gt;可以看到，同时包含了元素符号、晶格和原子坐标信息。其实这个自定义风格，&lt;code&gt;custom&lt;/code&gt;，就是稍加修改的&lt;code&gt;atom&lt;/code&gt;风格。&lt;/p&gt;&#xA;&lt;p&gt;剩下的问题就是，如何将lammps的dump文件转化为xyz文件，再由xyz文件转化为POSCAR。&lt;/p&gt;&#xA;&lt;p&gt;OVITO模块读取dump文件比较好用，个人觉得比ase的强，所以这里采用ovito模块，如下：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from ovito.io import import_file,export_file&#xD;&#xA;&#xD;&#xA;pipeline = import_file(&#39;dump&#39;)&#xD;&#xA;&#xD;&#xA;for frame,data in enumerate(pipeline.frames):&#xD;&#xA;    if frame &amp;lt; 10:&#xD;&#xA;        export_file(data,&amp;quot;xyz{}&amp;quot;.format(frame),format=&amp;quot;xyz&amp;quot;,columns =[&amp;quot;Particle Identifier&amp;quot;, &amp;quot;Particle Type&amp;quot;, &amp;quot;Position.X&amp;quot;, &amp;quot;Position.Y&amp;quot;, &amp;quot;Position.Z&amp;quot;])&#xD;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;这里简单测试一下，只输出了前10个结构。结果很成功。&lt;/p&gt;</description>
    </item>
    <item>
      <title>LAMMPS中的常见命令</title>
      <link>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/lammps%E4%B8%AD%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/</link>
      <pubDate>Tue, 17 Jun 2025 00:00:00 +0000</pubDate>
      <guid>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/lammps%E4%B8%AD%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/</guid>
      <description>&lt;h1 id=&#34;lammps中的常见命令&#34;&gt;LAMMPS中的常见命令&lt;/h1&gt;&#xA;&lt;h2 id=&#34;前言&#34;&gt;前言&lt;/h2&gt;&#xA;&lt;p&gt;虽然说是常见，但也未必常见吧，可能只是我遇到的不懂的、或者觉得有趣的。&lt;/p&gt;&#xA;&lt;h3 id=&#34;1labelmap&#34;&gt;1.&lt;code&gt;labelmap&lt;/code&gt;&lt;/h3&gt;&#xA;&lt;p&gt;&lt;code&gt;lablemap atom 1 H 2 O&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;这个命令用于给atom type指定一个映射关系。在用&lt;code&gt;write_data&lt;/code&gt;写当前帧的data文件时，文件会含有额外的信息，如下：&lt;/p&gt;&#xA;&lt;img src=&#34;https://xiaoxiaobuaigugujiao.oss-cn-beijing.aliyuncs.com/img/labelmap.png&#34; style=&#34;zoom:60%;&#34; /&gt;&#xD;&#xA;&lt;p&gt;但只限于data文件，无法影响dump的轨迹文件，所以想要写带有元素符号的轨迹，还是用dump的custom风格比较好。&lt;/p&gt;&#xA;&lt;h3 id=&#34;2-variable&#34;&gt;2. &lt;code&gt;variable&lt;/code&gt;&lt;/h3&gt;&#xA;&lt;p&gt;想要精通LAMMPS中的&lt;code&gt;variable&lt;/code&gt;总是要费一番功夫的，今日有幸认真研究一番（本身又涉及很多别的命令，真似高中时看牛津字典，遇到一个个新单词，好爽快）。&lt;/p&gt;&#xA;&lt;p&gt;不同风格的&lt;code&gt;variable&lt;/code&gt;的&lt;mark&gt;定义&lt;/mark&gt;和&lt;mark&gt;使用&lt;/mark&gt;，会有一些差异。&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;variable name style args ...&#xD;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;这是官方给出的&lt;code&gt;variable&lt;/code&gt;语法，简明扼要，&lt;code&gt;variable&lt;/code&gt;由名字、风格、参数组成。&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;equal&lt;/code&gt;风格&lt;/p&gt;&#xA;&lt;p&gt;它后接一个公式，可以包含：数字、常数、数学算符、内置函数、原子值（atom values）、原子矢量（atom vectors）以及compute/fix/variable的引用。&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;  atom value = id[i], mass[i], type[i], mol[i], x[i], y[i], z[i], vx[i], vy[i], vz[i], fx[i], fy[i], fz[i], q[i]&#xD;&#xA;  atom vector = id, mass, type, mol, radius, q, x, y, z, vx, vy, vz, fx, fy, f&#xD;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;这里，原子值是某个原子的信息，而原子矢量则是包含全体原子的信息。&lt;/p&gt;&#xA;&lt;p&gt;值得注意的是，如果涉及到原子值，在&lt;code&gt;atom_style&lt;/code&gt;之后，还要打开&lt;code&gt;atom_modify map yes&lt;/code&gt;。&lt;/p&gt;</description>
    </item>
    <item>
      <title>LAMMPS剪切模拟</title>
      <link>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/lammps%E5%89%AA%E5%88%87%E6%A8%A1%E6%8B%9F/</link>
      <pubDate>Sat, 14 Jun 2025 00:00:00 +0000</pubDate>
      <guid>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/lammps%E5%89%AA%E5%88%87%E6%A8%A1%E6%8B%9F/</guid>
      <description>&lt;h1 id=&#34;lammps用于剪切模拟的in文件&#34;&gt;LAMMPS用于剪切模拟的in文件&lt;/h1&gt;&#xA;&lt;pre&gt;&lt;code&gt;# 3d metal shear simulation&#xD;&#xA;&#xD;&#xA;units&#x9;&#x9;metal&#xD;&#xA;boundary&#x9;s s p&#xD;&#xA;&#xD;&#xA;atom_style&#x9;atomic&#xD;&#xA;lattice&#x9;&#x9;fcc 3.52&#xD;&#xA;region&#x9;&#x9;box block 0 16.0 0 10.0 0 2.828427&#xD;&#xA;create_box&#x9;3 box&#xD;&#xA;&#xD;&#xA;lattice&#x9;&#x9;fcc 3.52 orient&#x9;x 1 0 0 orient y 0 1 1 orient z 0 -1 1 &amp;amp;&#xD;&#xA;&#x9;&#x9;origin 0.5 0 0 &#xD;&#xA;create_atoms&#x9;1 box&#xD;&#xA;&#xD;&#xA;pair_style&#x9;eam&#xD;&#xA;pair_coeff&#x9;* * Ni_u3.eam&#xD;&#xA;&#xD;&#xA;neighbor&#x9;0.3 bin&#xD;&#xA;neigh_modify&#x9;delay 5&#xD;&#xA;&#xD;&#xA;region&#x9;&#x9;lower block INF INF INF 0.9 INF INF&#xD;&#xA;region&#x9;&#x9;upper block INF INF 6.1 INF INF INF&#xD;&#xA;group&#x9;&#x9;lower region lower&#xD;&#xA;group&#x9;&#x9;upper region upper&#xD;&#xA;group&#x9;&#x9;boundary union lower upper&#xD;&#xA;group&#x9;&#x9;mobile subtract all boundary&#xD;&#xA;&#xD;&#xA;set&#x9;&#x9;group lower type 2&#xD;&#xA;set&#x9;&#x9;group upper type 3&#xD;&#xA;&#xD;&#xA;# void&#xD;&#xA;&#xD;&#xA;#region&#x9;&#x9;void cylinder z 8 5 2.5 INF INF&#xD;&#xA;#delete_atoms&#x9;region void&#xD;&#xA;&#xD;&#xA;# temp controllers&#xD;&#xA;&#xD;&#xA;compute&#x9;&#x9;new3d mobile temp&#xD;&#xA;compute&#x9;&#x9;new2d mobile temp/partial 0 1 1&#xD;&#xA;&#xD;&#xA;# equilibrate&#xD;&#xA;&#xD;&#xA;velocity&#x9;mobile create 300.0 5812775 temp new3d&#xD;&#xA;fix&#x9;&#x9;1 all nve&#xD;&#xA;fix&#x9;&#x9;2 boundary setforce 0.0 0.0 0.0&#xD;&#xA;&#xD;&#xA;fix&#x9;&#x9;3 mobile temp/rescale 10 300.0 300.0 10.0 1.0&#xD;&#xA;fix_modify&#x9;3 temp new3d&#xD;&#xA;&#xD;&#xA;thermo&#x9;&#x9;25&#xD;&#xA;thermo_modify&#x9;temp new3d&#xD;&#xA;&#xD;&#xA;timestep&#x9;0.001&#xD;&#xA;run&#x9;&#x9;100&#xD;&#xA;&#xD;&#xA;# shear&#xD;&#xA;&#xD;&#xA;velocity&#x9;upper set 1.0 0 0&#xD;&#xA;velocity&#x9;mobile ramp vx 0.0 1.0 y 1.4 8.6 sum yes&#xD;&#xA;&#xD;&#xA;unfix&#x9;&#x9;3&#xD;&#xA;fix&#x9;&#x9;3 mobile temp/rescale 10 300.0 300.0 10.0 1.0&#xD;&#xA;fix_modify&#x9;3 temp new2d&#xD;&#xA;&#xD;&#xA;#dump&#x9;&#x9;1 all atom 100 dump.shear&#xD;&#xA;&#xD;&#xA;#dump&#x9;&#x9;2 all image 100 image.*.jpg type type &amp;amp;&#xD;&#xA;#&#x9;&#x9;axes yes 0.8 0.02 view 0 0 zoom 1.5 up 0 1 0 adiam 2.0&#xD;&#xA;#dump_modify&#x9;2 pad 4&#xD;&#xA;&#xD;&#xA;#dump&#x9;&#x9;3 all movie 100 movie.mpg type type &amp;amp;&#xD;&#xA;#&#x9;&#x9;axes yes 0.8 0.02 view 0 0 zoom 1.5 up 0 1 0 adiam 2.0&#xD;&#xA;#dump_modify&#x9;3 pad 4&#xD;&#xA;&#xD;&#xA;thermo&#x9;&#x9;100&#xD;&#xA;thermo_modify&#x9;temp new2d&#xD;&#xA;&#xD;&#xA;reset_timestep&#x9;0&#xD;&#xA;run&#x9;&#x9;3000&#xD;&#xA;&#xD;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h3 id=&#34;compute--id--group-id--temp&#34;&gt;&lt;code&gt;compute  ID  group-ID  temp&lt;/code&gt;&lt;/h3&gt;&#xA;&lt;p&gt;计算某个原子群的温度&lt;/p&gt;</description>
    </item>
    <item>
      <title>使用rNEMD方法计算热导率的lammps输入文件</title>
      <link>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/thermal_conductivity_rnemd/</link>
      <pubDate>Fri, 16 May 2025 00:00:00 +0000</pubDate>
      <guid>https://liubaoshuai1402.github.io/%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6/thermal_conductivity_rnemd/</guid>
      <description>&lt;h1 id=&#34;使用rnemd方法计算热导率的lammps输入文件&#34;&gt;使用rNEMD方法计算热导率的LAMMPS输入文件&lt;/h1&gt;&#xA;&lt;h2 id=&#34;前言&#34;&gt;前言&lt;/h2&gt;&#xA;&lt;p&gt;&#xD;&#xA;&lt;a href=&#34;https://doi.org/10.1063/1.473271&#34;  target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34; &gt;rNEMD方法&lt;/a&gt;&#xD;&#xA;，又叫MP方法，计算材料热导率。&lt;/p&gt;&#xA;&lt;p&gt;LAMMPS官方提供了计算脚本，但是使用的单位却是&lt;code&gt;lj&lt;/code&gt;单位制，非常不实用，这里是我自己写的&lt;code&gt;metal&lt;/code&gt;单位制下的脚本。&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：本文仅供参考，欢迎指出错误或分享补充。无能力提供任何指导，&lt;strong&gt;求教者切勿留言&lt;/strong&gt;。&lt;/p&gt;&#xA;&lt;h2 id=&#34;in-file&#34;&gt;in file&lt;/h2&gt;&#xA;&lt;pre&gt;&lt;code&gt;# sample LAMMPS input script for thermal conductivity of liquid LJ&#xD;&#xA;# Muller-Plathe method via fix thermal_conductivity&#xD;&#xA;&#xD;&#xA;# settings      temperature, kB and timestep&#xD;&#xA;&#xD;&#xA;variable        t equal 1500&#xD;&#xA;variable        k equal 8.6173e-5 &#xD;&#xA;variable        dt equal 0.0005&#xD;&#xA;&#xD;&#xA;# convert from LAMMPS metal units to SI&#xD;&#xA;variable        eV2J equal 1.6022e-19          #energy convert&#xD;&#xA;variable        A2m equal 1.0e-10           #distance convert&#xD;&#xA;variable        ps2s equal 1.0e-12          #time convert  &#xD;&#xA;variable        convert equal ${eV2J}/${ps2s}/${A2m}          &#xD;&#xA;&#xD;&#xA;# setup problem&#xD;&#xA;&#xD;&#xA;units           metal&#xD;&#xA;atom_style      atomic&#xD;&#xA;atom_modify     map yes&#xD;&#xA;newton          on&#xD;&#xA;read_data       ./333&#xD;&#xA;pair_style      mace no_domain_decomposition&#xD;&#xA;pair_coeff * *  /home-ssd/Users/nsgm_lbs/train/MACE_model/MACE_model_run-123_stagetwo.model-lammps.pt O Zr Y H&#xD;&#xA;neighbor        1.0 bin&#xD;&#xA;neigh_modify    every 500 delay 0 check no&#xD;&#xA;minimize        1e-5 1e-7 1000 1000&#xD;&#xA;timestep        ${dt}&#xD;&#xA;velocity        all create $t 87287&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;# 1st equilibration run&#xD;&#xA;reset_timestep  0&#xD;&#xA;fix             1 all npt temp $t $t 0.05 iso 0 0 0.5&#xD;&#xA;thermo_style    custom step temp pe etotal enthalpy lx ly lz vol press&#xD;&#xA;thermo          100&#xD;&#xA;run             5000&#xD;&#xA;unfix           1&#xD;&#xA;velocity        all scale $t&#xD;&#xA;fix             1 all nvt temp $t $t 0.05&#xD;&#xA;run             5000&#xD;&#xA;unfix           1&#xD;&#xA;&#xD;&#xA;# 2nd equilibration run&#xD;&#xA;compute         ke all ke/atom&#xD;&#xA;variable        temp atom c_ke/1.5/${k}&#xD;&#xA;&#xD;&#xA;fix             1 all nve&#xD;&#xA;&#xD;&#xA;compute         layers all chunk/atom bin/1d z lower 0.05 units reduced&#xD;&#xA;fix             2 all ave/chunk 10 100 1000 layers v_temp file profile.mp&#xD;&#xA;fix             3 all thermal/conductivity 100 z 20&#xD;&#xA;&#xD;&#xA;variable        tdiff equal f_2[11][3]-f_2[1][3]&#xD;&#xA;thermo_style    custom step temp epair etotal f_3 v_tdiff&#xD;&#xA;thermo_modify   colname f_3 E_delta colname v_tdiff dTemp_step&#xD;&#xA;&#xD;&#xA;thermo          1000&#xD;&#xA;run             20000&#xD;&#xA;&#xD;&#xA;# thermal conductivity calculation&#xD;&#xA;# reset fix thermal/conductivity to zero energy accumulation&#xD;&#xA;fix             3 all thermal/conductivity 100 z 20&#xD;&#xA;variable        start_time equal time&#xD;&#xA;variable        kappa equal (f_3/(time-${start_time})/(lx*ly)/2.0)*(lz/2.0)/f_ave&#xD;&#xA;fix             ave all ave/time 1 1 1000 v_tdiff ave running&#xD;&#xA;thermo_style    custom step temp epair etotal f_3 v_tdiff f_ave&#xD;&#xA;thermo_modify   colname f_3 E_delta colname v_tdiff dTemp_step colname f_ave dTemp&#xD;&#xA;run             20000&#xD;&#xA;print           &amp;quot;Running average thermal conductivity units metal: $(v_kappa)&amp;quot;&#xD;&#xA;variable        tc  equal ${kappa}*${convert}&#xD;&#xA;print           &amp;quot;Running average thermal conductivity units SI: $(v_tc:%.2f)&amp;quot;&#xD;&#xA;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
  </channel>
</rss>
